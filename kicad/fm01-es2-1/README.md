# FM01-ES2-1

胖蚊子 1 号 (FM01) 用来承载 esp32-s2 wrover-i 模块的 PCB 小板.


## PCB 设计参数

| 序号 | 项目 | 数值 |
| :--: | :-- | ---: |
| 1 | PCB 大小 | 20x32mm |
| 2 | 材质 | FR-4 厚度 1.0mm 铜箔厚度 1oz (35um) |
| 3 | 层数 | 2 (双面) |
| 4 | 最小线宽线距 | 0.16mm (6mil) |
| 5 | 最小过孔内径 | 0.3mm |
| 6 | 最小过孔外径 | 0.6mm |
| 7 | 最小字符高度 | 0.8mm |
| 8 | 最小过孔间距 | 0.4mm |
| 9 | 最小过孔与线间距 | 0.25mm |
| 10 | 最小非金属化槽宽度 | 0.8mm |

推荐加工厂: [捷配](https://www.jiepei.com/)


## 元件清单

| 序号 | 引用 | 型号 | 封装 | 数量 | 价格 (CNY) |
| :--: | :-- | :--- | :--: | --: | ---------: |
| 1 | `U1` | [esp32-s2 wrover-i](https://www.espressif.com/sites/default/files/documentation/esp32-s2-wrover_esp32-s2-wrover-i_datasheet_cn.pdf) (4MB) 模块 | 18x31mm | 1 | 20 |
| 2 | `D1` | 翠绿色 LED (电源指示灯) | SMD 0402 | 1 | 0.04 |
| 3 | `D2` | 冰蓝色 LED (状态指示灯) | SMD 0402 | 1 | 0.08 |
| 4 | `J1` | micro-USB 插座 (连接上位机) | SMD (F2B4) | 1 | 0.09 |
| 5 | `J2`, `J3` | 1.25mm 10P 插座 卧式 | SMD | 2 | 0.34 x2 = 0.68 |
| 6 | `J4` | FFC/FPC 0.5mm 30P 插座 翻盖式 | SMD | 1 | 0.45 |
| 7 | `C1` | 电容 22uF | SMD 钽电容 A型 (3216-18) | 1 | 0.81 |
| 8 | `C2`, `C3`, `C4` | 电容 0.1uF | SMD 0402 | 3 | 0.01 x3 = 0.03 |
| 9 | `C10`, `C11` | 电容 20pF (不上件) | SMD 0402 | 2 | 0.03 x2 |
| 10 | `R1`, `R2` | 电阻 22 | SMD 0402 | 2 | 0.024 x2 = 0.05 |
| 11 | `R3`, `R18`, `R34` | 电阻 10k | SMD 0402 | 3 | 0.024 x3 = 0.08 |
| 12 | `R4`, `R10`, `R11`, `R35`, `R36`, `R53` | 电阻 0 | SMD 0402 | 6 | 0.024 x6 = 0.15 |
| 13 | `R30`, `R31`, `R32`, `R33`, `R50`, `R51`, `R52` | 电阻 1k | SMD 0402 | 7 | 0.024 x7 = 0.17 |
| 总计 | 31 | 13 | 6 | 29 | 20 + 2.62 = 22.62 |

注: 价格仅供参考.


## 接口引脚说明

+ **J1** micro-USB (USB1.1 12Mbps)

  上位机接口, 用于连接 esp32-s2 (作为 USB device) 和上位机 (USB host).

+ **J2** 主要功能连接 (1.25mm 10P)

  | 序号 | 名称 | 说明 |
  | :--: | :-- | :--- |
  | 1 | `3V3` | 3.3V 电源供电 |
  | 2 | `GND` | 接地 |
  | 3 | `IO1` | 引出 esp32-s2 的 `IO1` |
  | 4 | `IO2` | 引出 esp32-s2 的 `IO2` |
  | 5 | `IO3` | 引出 esp32-s2 的 `IO3` |
  | 6 | `IO4` | 引出 esp32-s2 的 `IO4` |
  | 7 | `IO5` | 引出 esp32-s2 的 `IO5` |
  | 8 | `IO6` | 引出 esp32-s2 的 `IO6` |
  | 9 | `IO7` | 引出 esp32-s2 的 `IO7` |
  | 10 | `IO8` | 引出 esp32-s2 的 `IO8` |

+ **J3** 次要功能连接 (1.25mm 10P)

  | 序号 | 名称 | 说明 |
  | :--: | :-- | :--- |
  | 1 | `VI` | 电流传感器电压输入 (用于电流测量功能) |
  | 2 | `GND` | 接地 |
  | 3 | `IO13` | 引出 esp32-s2 的 `IO13`, 与 `J4` 共同引出 |
  | 4 | `IO14` | 引出 esp32-s2 的 `IO14`, 与 `J4` 共同引出 |
  | 5 | `IO15` | 引出 esp32-s2 的 `IO15` |
  | 6 | `IO16` | 引出 esp32-s2 的 `IO16` |
  | 7 | `IO17` | 引出 esp32-s2 的 `IO17` |
  | 8 | `IO18` | 引出 esp32-s2 的 `IO18` (带 10k 上拉电阻) |
  | 9 | `GND` | 接地 |
  | 10 | `VBAT` | 电池电压输入 (用于电池电压测量功能) |

+ **J4** 扩展 (调试) 功能连接 (FFC/FPC 0.5mm 30P)

  | 序号 | 名称 | 说明 |
  | :--: | :-- | :--- |
  | 1 | `GND` | |
  | 2 | `BOOT` | 启动选项: 悬空 SPI 启动模式; 接地 下载启动模式 |
  | 3 | `RESET` | 重置开关: 悬空 正常使能芯片; 接地 RESET |
  | 4 | `BOOT_LOG` | 启动 boot code 打印选项 (通常无用) |
  | 5 | `GND` | |
  | 6 | `RXD0` | UART0 RX (默认用于调试) |
  | 7 | `TXD0` | UART0 TX (默认用于调试) |
  | 8 | `GND` | |
  | 9 | `TMS` | 用于 JTAG 调试 |
  | 10 | `TDI` | 用于 JTAG 调试 |
  | 11 | `TDO` | 用于 JTAG 调试 |
  | 12 | `TCK` | 用于 JTAG 调试 |
  | 13 | `GND` | |
  | 14 | `IO38` | 引出 esp32-s2 的 `IO38` |
  | 15 | `IO37` | 引出 esp32-s2 的 `IO37` |
  | 16 | `IO36` | 引出 esp32-s2 的 `IO36` |
  | 17 | `IO35` | 引出 esp32-s2 的 `IO35` |
  | 18 | `IO34` | 引出 esp32-s2 的 `IO34` |
  | 19 | `IO33` | 引出 esp32-s2 的 `IO33` |
  | 20 | `GND` | |
  | 21 | `LED1` | 引出状态指示灯 (`D2`) 控制信号 (`IO21`) |
  | 22 | `3V3` | 3.3V 电源供电 |
  | 23 | `GND` | |
  | 24 | `IO9` | 引出 esp32-s2 的 `IO9`, 复用功能: `VI` 测量 (电流传感器) |
  | 25 | `IO10` | 引出 esp32-s2 的 `IO10`, 复用功能: `VBAT` 测量 (电池电压) |
  | 26 | `IO11` | 引出 esp32-s2 的 `IO11` |
  | 27 | `IO12` | 引出 esp32-s2 的 `IO12`, 复用功能: `VBUS` 测量 (USB 供电电压) |
  | 28 | `IO13` | 引出 esp32-s2 的 `IO13`, 与 `J3` 共同引出 |
  | 29 | `IO14` | 引出 esp32-s2 的 `IO14`, 与 `J3` 共同引出 |
  | 30 | `GND` | |


## 功能电路

+ **D1** 电源指示灯 (翠绿色)

  | 项目 | 说明 |
  | :--: | :-- |
  | 功能可选 | 是 (`D1`, `R1` 不上件) |
  | 电源电压 | 3.3V |
  | LED 电流 | 20mA |

+ **D2** 状态指示灯 (冰蓝色)

  | 项目 | 说明 |
  | :--: | :-- |
  | 功能可选 | 是 (`D2`, `R2` 不上件) |
  | 电源电压 | 3.3V |
  | LED 电流 | 20mA |
  | esp32-s2 引脚 | `IO21` |
  | 接口引脚 | `LED1` (`J4` 21) |

+ **VI** 电流传感器电压检测

  | 项目 | 说明 |
  | :--: | :-- |
  | 功能可选 | 是 (`R36` 以及 `R30`, `R31`, `R32` 不上件) |
  | `VI` 量程 | 7.5V |
  | `VI` 电压缩小比例 | `3:1` |
  | `VI` 对地电阻 | 3k |
  | esp32-s2 引脚 | `IO9` |
  | 接口引脚 | `VI` (`J3` 1), `IO9` (`J4` 24) |

+ **VBAT** 电池电压检测

  | 项目 | 说明 |
  | :--: | :-- |
  | 功能可选 | 是 (`R35` 以及 `R33`, `R34` 不上件) |
  | `VBAT` 量程 | 27.5V |
  | `VBAT` 电压缩小比例 | `11:1` |
  | `VBAT` 对地电阻 | 11k |
  | esp32-s2 引脚 | `IO10` |
  | 接口引脚 | `VBAT` (`J3` 10), `IO10` (`J4` 25) |

+ **VBUS** USB 供电电压检测

  | 项目 | 说明 |
  | :--: | :-- |
  | 功能可选 | 是 (`R53` 不上件) |
  | `VBUS` 量程 | 7.5V |
  | `VBUS` 电压缩小比例 | `3:1` |
  | `VBUS` 对地电阻 | 3k |
  | esp32-s2 引脚 | `IO12` |
  | 接口引脚 | `IO12` (`J4` 27) |

+ **RESET** 芯片重置

  | 项目 | 说明 |
  | :--: | :-- |
  | 功能可选 | 是 (`R4`, `C4` 不上件) |
  | 接口引脚 | `RESET` (`J4` 3) |


## 保护电路

TODO


(2020-10-31 `v0.1`)
